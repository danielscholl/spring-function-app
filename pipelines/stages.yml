parameters:
  environments: []

stages:

- stage: mvntest
  displayName: 'Project Test'
  jobs:
  - template: test.yml

- stage: dockerbuild
  displayName: 'Docker Build'
  jobs:
  - template: docker-build.yml

- ${{ each environment in parameters.environments }}:
  - stage: ${{ environment.name }}_deploy
    displayName: 'Push ACR-${{ environment.name }}'
    jobs:
    - template: docker-push.yml
      parameters:
        environment: ${{ environment.name }}
        acr_registry_name: ${{ environment.acrRegistryName }}
        acr_service_connection: ${{ environment.acrServiceConnection }}
