# Required Group Variables
  # ACR_DEV_NAME:
  # ACR_DEV_CONNECTION:
  # ACR_QA_NAME:
  # ACR_QA_CONNECTION:
  # ACR_PROD_NAME:
  # ACR_PROD_CONNECTION:

trigger:
  batch: true
  branches:
    include:
    - master
  paths:
    include:
    - azure-pipelines.yml
    - /pipelines/*
    - /src/*
    exclude:
    - /**/*.md


variables:
- group: 'acr-variables'
- name: 'ImageName'
  value: 'spring-function-app'

stages:
- template: pipelines/stages.yml
  parameters:
    environments:
    - name: 'dev'
      acrRegistryName: $(ACR_DEV_NAME)
      acrServiceConnection: $(ACR_DEV_CONNECTION)
    - name: 'qa'
      acrRegistryName: $(ACR_QA_NAME)
      acrServiceConnection: $(ACR_QA_CONNECTION)
    - name: 'prod'
      acrRegistryName: $(ACR_PROD_NAME)
      acrServiceConnection: $(ACR_PROD_CONNECTION)
